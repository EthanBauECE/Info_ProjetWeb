<!DOCTYPE html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medicare</title>
  <link rel="icon" type="image/png" href="medicare_logo.png" />
  <link rel="stylesheet" href="style.css" />
</head>

 <body>

  <header>
    <div class="header-container">
      <img src="medicare_logo.png" alt="Logo Medicare" class="logo">
      <h1>Medicare : Services Médicaux</h1>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li class="dropdown">
          <a href="parcourir.html">Tout Parcourir</a>
          <ul class="dropdown-menu">
            <li><a href="medecine_general.html">Médecine générale</a></li>
            <li><a href="medecins_special.html">Médecins spécialisés</a></li>
            <li><a href="laboratoire.html">Laboratoire de biologie médicale</a></li>
          </ul>
        </li>
        <li><a href="recherche.html">Recherche</a></li>
        <li><a href="rdv.html">Rendez-vous</a></li>
        <li><a href="compte.html">Votre Compte</a></li>
      </ul>
    </nav>    
  </header>
  <div class="rdv-container">
    <?php
    // (Connexion à la base de données)
    $pdo = new PDO('mysql:host=localhost;dbname=medicare;charset=utf8', 'root', 'root');
    date_default_timezone_set('Europe/Paris');
    
    // (Supposons que l'utilisateur est connecté avec user_id = 5)
    $stmt = $pdo->prepare("SELECT * FROM rendezvous WHERE user_id = ? ORDER BY date ASC, heure ASC");
    $stmt->execute([5]);
    
    while ($rdv = $stmt->fetch()) {
        // Fusionne date et heure pour comparer à maintenant
        $datetime_rdv = strtotime($rdv['date'] . ' ' . $rdv['heure']);
        $now = time();
        $is_past = $datetime_rdv < $now;
    
        echo '<div class="rdv-box">';
        echo   '<div class="rdv-photo">';
        echo     '<img src="' . $rdv['photo_medecin'] . '" alt="photo médecin">';
        echo     '<p>photo<br>médecin<br>demandé</p>';
        echo   '</div>';
        echo   '<div class="rdv-details">';
        echo     '<h2>Détails rendez-vous</h2>';
        echo     '<p><strong>Médecin :</strong> ' . htmlspecialchars($rdv['nom_medecin']) . '</p>';
        echo     '<p><strong>Date :</strong> ' . htmlspecialchars($rdv['date']) . '</p>';
        echo     '<p><strong>Heure :</strong> ' . htmlspecialchars($rdv['heure']) . '</p>';
    
        if ($is_past) {
            echo '<div class="past-label">Passé</div>';
        } else {
            echo '<form method="POST" action="annuler_rdv.php">';
            echo   '<input type="hidden" name="id_rdv" value="' . $rdv['id'] . '">';
            echo   '<button type="submit" class="btn-annuler">Annuler le rdv</button>';
            echo '</form>';
        }
    
        echo   '</div>';
        echo '</div>';
    }
    ?>
    </div>
    
  </main>

  <footer>
    <p>Contactez-nous : contact@medicare.omnes</p>
    <p>Téléphone : 01 23 45 67 89</p>
    <div id="map">
      Adresse : 10 rue des Médecins, Paris
    </div>
  </footer>
</body>
</html>
